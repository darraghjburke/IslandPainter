{"version":3,"sources":["logo.svg","SceneComponent.tsx","schema/MyRoomState.ts","schema/WorldObjects.ts","TilePanel.tsx","Chat.tsx","Help.tsx","Game.tsx","App.js","reportWebVitals.js","index.js"],"names":["props","reactCanvas","useRef","antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","rest","onSceneReady","useEffect","current","engine","Engine","scene","Scene","isReady","onReadyObservable","addOnce","runRenderLoop","render","resize","getEngine","window","addEventListener","dispose","removeEventListener","ref","Color3","type","Schema","Player","Building","Tile","Message","MyRoomState","ArraySchema","terrainTypes","name","color","asset","buildingTypes","probability","TilePanel","useState","rotation","setRotationLocal","height","setHeightLocal","tile","building","id","className","map","index","onClick","setTerrainType","terrainType","style","backgroundColor","htmlFor","step","min","max","value","onChange","ev","setHeight","updateHeight","parseFloat","target","Math","PI","setRotation","updateRotation","demolishBuilding","includes","buildBuilding","text","setText","messages","scrollTop","scrollHeight","length","players","player","r","g","b","message","onSubmit","event","preventDefault","sendMessage","autoComplete","Help","visible","setVisible","href","GameObject","folder","glb","assetManager","parentMesh","addMeshTask","process","onSuccess","task","loadedMeshes","position","z","focusedKey","setFocusedKey","roomState","setRoomState","React","updateState","forceUpdate","useCallback","room","setRoom","terrains","buildings","a","AssetsManager","forEach","push","loadAsync","getPixelFromHex","col","row","sqrt","connect","Colyseus","joinOrCreate","then","console","log","sessionId","onStateChange","state","cx","cy","cameras","set","radius","tiles","onAdd","key","width","floor","getCoords","x","y","transformNode","TransformNode","metadata","terrainMesh","clone","isPickable","buildingNode","listen","currentValue","previousValue","animation","Animation","CreateAndStartAnimation","loopAnimation","onAnimationEndObservable","add","eventData","parent","setEnabled","onPointerObservable","pointerInfo","pickInfo","pickedMesh","keyNode","PointerEventTypes","POINTERDOWN","catch","e","SceneComponent","loadGameData","camera","ArcRotateCamera","Vector3","setTarget","Zero","canvas","getRenderingCanvas","attachControl","HemisphericLight","intensity","send","Chat","App","Game","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b02e918e.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import { Engine, Scene } from \"@babylonjs/core\";\nimport React, { useEffect, useRef } from \"react\";\n\nexport default (props : any) => {\n  const reactCanvas = useRef(null);\n  const { antialias, engineOptions, adaptToDeviceRatio, sceneOptions, onRender, onSceneReady, ...rest } = props;\n\n  useEffect(() => {\n    if (reactCanvas.current) {\n      const engine = new Engine(reactCanvas.current, antialias, engineOptions, adaptToDeviceRatio);\n      const scene = new Scene(engine, sceneOptions);\n      if (scene.isReady()) {\n        props.onSceneReady(scene);\n      } else {\n        scene.onReadyObservable.addOnce((scene) => props.onSceneReady(scene));\n      }\n\n      engine.runRenderLoop(() => {\n        if (typeof onRender === \"function\") {\n          onRender(scene);\n        }\n        scene.render();\n      });\n\n      const resize = () => {\n        scene.getEngine().resize();\n      };\n\n      if (window) {\n        window.addEventListener(\"resize\", resize);\n      }\n\n      return () => {\n        scene.getEngine().dispose();\n\n        if (window) {\n          window.removeEventListener(\"resize\", resize);\n        }\n      };\n    }\n  }, [reactCanvas]);\n\n  return <canvas ref={reactCanvas} {...rest} />;\n};\n","import { Schema, type, ArraySchema } from \"@colyseus/schema\";\n\nexport class Vector3 extends Schema {\n  @type(\"number\") x: number = 0;\n  @type(\"number\") y: number = 0;\n  @type(\"number\") z: number = 0;\n}\n\nexport class Color3 extends Schema {\n  @type(\"number\") r: number = 0;\n  @type(\"number\") g: number = 0;\n  @type(\"number\") b: number = 0;\n}\n\nexport class Player extends Schema {\n  @type(\"string\") id: string;\n  @type(Color3) color: Color3;\n  @type(\"string\") name: string;\n}\n\nexport class Building extends Schema {\n  @type(\"number\") type: number = 0;\n  @type(\"number\") rotation: number = 0;\n}\n\nexport class Tile extends Schema {\n  @type(\"number\") terrainType: number = 0;\n  @type(\"number\") height: number = 0;\n  @type(Building) building : Building = null;\n}\n\nexport class Message extends Schema {\n  @type(\"string\") name: string = \"\";\n  @type(Color3) color: Color3;\n  @type(\"string\") message : string = \"\";\n}\n\nexport class MyRoomState extends Schema {\n  @type([Player]) players = new ArraySchema<Player>();\n  @type(\"number\") width: number = 25;\n  @type(\"number\") height: number = 25;\n  @type([Tile]) tiles = new ArraySchema<Tile>();\n  @type(\"string\") name: String = \"\";\n  @type([Message]) messages = new ArraySchema<Message>();\n}\n","export interface TerrainType {\n    name: string;\n    asset: string\n}\n\nexport interface BuildingType {\n    name: string;\n    terrainTypes: number[];\n    asset: string;\n    probability: number;\n}\n\nexport const terrainTypes = [\n    {\n        name: \"Grass\",\n        color: \"#3F9C74\",\n        asset: \"hex_forest\"\n    },\n    {\n        name: \"Water\",\n        color: \"#3EB2BB\",\n        asset: \"hex_water\"\n    },\n    {\n        name: \"Sand\",\n        color: \"#B69169\",\n        asset: \"hex_sand\"\n    },\n    {\n        name: \"Dirt\",\n        color: \"#A76F52\",\n        asset: \"hex_rock\"\n    }\n]\n\nexport const buildingTypes : BuildingType[] = [\n    {\n        name: \"Forest\",\n        terrainTypes: [0],\n        asset: \"forest1\",\n        probability: 0.2\n\n    },\n    {\n        name: \"Forest with Rock\",\n        terrainTypes: [0],\n        asset: \"forest2\",\n        probability: 0.2\n    },\n    {\n        name: \"Rocks\",\n        terrainTypes: [0,2,3],\n        asset: \"rocks_small\",\n        probability: 0.1\n    },\n    {\n        name: \"Mountain\",\n        terrainTypes: [0,2,3],\n        asset: \"mountain\",\n        probability: 0.02\n    },\n    {\n        name: \"House\",\n        terrainTypes: [0,2],\n        asset: \"house\",\n        probability: 0.02\n    },\n    {\n        name: \"Farm\",\n        terrainTypes: [0],\n        asset: \"farm_plot\",\n        probability: 0.02\n    },\n    {\n        name: \"Mine\",\n        terrainTypes: [0,2,3],\n        asset: \"mine\",\n        probability: 0.01\n    },\n    {\n        name: \"Market\",\n        terrainTypes: [0,2,3],\n        asset: \"market\",\n        probability: 0.01\n    },\n    {\n        name: \"Windmill\",\n        terrainTypes: [0,2,3],\n        asset: \"mill\",\n        probability: 0.005\n    },\n    {\n        name: \"Lumbermill\",\n        terrainTypes: [0],\n        asset: \"lumbermill\",\n        probability: 0.01\n    },\n    {\n        name: \"Barracks\",\n        terrainTypes: [0,2,3],\n        asset: \"barracks\",\n        probability: 0.01\n    },\n    {\n        name: \"Archery Range\",\n        terrainTypes: [0,2,3],\n        asset: \"archeryrange\",\n        probability: 0.01\n    },\n    {\n        name: \"Watchtower\",\n        terrainTypes: [0,2,3],\n        asset: \"watchtower\",\n        probability: 0.01\n    },\n    {\n        name: \"Castle\",\n        terrainTypes: [0,2,3],\n        asset: \"castle\",\n        probability: 0.0005\n    },\n    {\n        name: \"Bridge\",\n        terrainTypes: [1],\n        asset: \"bridge\",\n        probability: 0\n    }\n]","import { useEffect, useState } from 'react';\nimport { Tile } from './schema/MyRoomState';\nimport { terrainTypes, buildingTypes } from './schema/WorldObjects';\n\n\ninterface TilePanelProps {\n    tile: Tile;\n    demolishBuilding: () => void;\n    buildBuilding: (type: number) => void;\n    setTerrainType: (type: number) => void;\n    setHeight: (height: number) => void;\n    setRotation: (rotation: number) => void;\n}\n\nexport default function TilePanel(props: TilePanelProps) {\n    const [rotation,setRotationLocal] = useState(0);\n    const [height,setHeightLocal] = useState(0);\n\n    useEffect(() => {\n        setHeightLocal(props.tile ? props.tile.height : 0);\n        if (props.tile && props.tile.building) {\n            setRotationLocal(props.tile.building.rotation);\n        }\n    }, [props.tile]);\n\n    const updateHeight = (height : number) => {\n        setHeightLocal(height);\n        props.setHeight(height);\n    }\n\n    const updateRotation = (rotation: number) => {\n        setRotationLocal(rotation);\n        props.setRotation(rotation);\n    }\n\n    return <div id=\"tile-panel\" className={!props.tile ? \"hide\" : \"\"}>\n        {\n        !props.tile ? <></> :\n        <>\n            <div id=\"terrain-type\">\n                {terrainTypes.map((type, index) => <button key={index} onClick={() => props.setTerrainType(index)} className={props.tile.terrainType == index ? \"terrain selected\" : \"terrain\" } style={{backgroundColor: type.color}}></button>)}\n            </div>\n            <div className=\"hr\"/>\n            <div id = \"height\">\n                <div><label htmlFor=\"height\">Height</label></div>\n                <input type=\"range\" step=\"0.05\" min=\"0\" max=\"2\" value={height} onChange={ev => updateHeight(parseFloat(ev.target.value))} id=\"height\"/>\n            </div>\n            <div className=\"hr\"/>\n            {!(props.tile.building) ?\n                <div id=\"no-building\">\n                    <h3>Build</h3>\n                    {buildingTypes.map((type, index) => type.terrainTypes.includes(props.tile.terrainType) ? <button key={type.name} onClick={() => props.buildBuilding(index)}>{type.name}</button> : <></>)}\n                </div>\n                :\n                <div id=\"building\">\n                    <h3>{buildingTypes[props.tile.building.type].name}</h3>\n                    <div><label htmlFor=\"rotation\">Rotation</label></div>\n                    <input type=\"range\" min=\"0\" max={2*Math.PI} step={0.1} value={rotation} onChange={ev => updateRotation(parseFloat(ev.target.value))} id=\"rotation\"/>\n                    <button onClick={props.demolishBuilding}>Demolish Building</button>\n                </div>\n            }\n        </>\n        }\n    </div>;\n}","import { Message, Player } from \"./schema/MyRoomState\"\nimport { FormEvent, useEffect, useRef, useState } from \"react\";\n\nexport default (props: {players: Player[], sendMessage: (text: string) => void, messages: Message[]}) => {\n    const [text,setText] = useState(\"\");\n    const messages = useRef<HTMLDivElement>(null);\n\n    const sendMessage = (event: FormEvent) => {\n        event.preventDefault();\n        if (text.length > 0) {\n            props.sendMessage(text);\n            setText(\"\");\n        }\n    }\n\n\n    useEffect(() => {\n        messages.current.scrollTop = messages.current.scrollHeight;\n    }, [props.messages.length])\n\n    return <div id=\"left-panel\">\n        <div id=\"online-players\">\n            <h3 id=\"player-count\">Online Players: {props.players.length}</h3>\n            {\n            props.players.map(player =><div key={player.id} className=\"player-name\" style={{color: `rgb(${player.color.r * 255},${player.color.g * 255},${player.color.b * 255})`}}>{player.name}</div>)\n            }\n        </div>\n        <div className=\"hr\"/>\n        <div id=\"chat\">\n            <div id=\"messages\" ref={messages}>\n            <h3>Chat</h3>\n                {props.messages.map(message => <div className=\"message\"><span className=\"player-name\" style={{color: `rgb(${message.color.r * 255},${message.color.g * 255},${message.color.b * 255})` }}>{message.name}</span><span>{message.message}</span></div>)}\n            </div>\n            <form id=\"chatbox\" onSubmit={sendMessage}>\n                <input autoComplete=\"off\" type=\"text\" value={text} onChange={(ev) => setText(ev.target.value)}/>\n                <button>Send</button>\n            </form>\n        </div>\n    </div>\n}","import { useState } from \"react\";\n\nexport default function Help() {\n    const [visible, setVisible] = useState(false);\n    return <>\n        {visible ?\n        <div id=\"help-box\">\n            <h1>Island Painter</h1>\n            <p>Powered by <a href=\"https://babylonjs.com/\">Babylon.js</a></p>\n            <p>Created by <a href=\"https://twitter.com/DarraghBurke13\">Darragh Burke</a></p>\n            <p>Get the source at <a href=\"https://github.com/darraghjburke/IslandPainter\">GitHub</a> </p>\n            <p>Networking using <a href=\"https://www.colyseus.io/\">Colyseus</a></p>\n            <p>Assets by <a href=\"https://kaylousberg.itch.io/kaykit-medieval-builder-pack\">Kay Lousberg</a> - check out their work!</p>\n            <p>Hex coordinate conversions by <a href=\"https://www.redblobgames.com/grids/hexagons\">RedBlobGames</a></p>\n            <p>Hand drawn CSS from <a href=\"https://codemyui.com/hand-drawn-border-buttons-css/\">CodeMyUI</a></p>\n            <button onClick={() => setVisible(false)}>X</button>\n        </div>\n        : <></> }\n        <button onClick={() => setVisible(!visible)} id=\"help-button\">?</button>\n    </>;\n}","import React, { useState } from \"react\";\nimport * as Colyseus from \"colyseus.js\"; // not necessary if included via <script> tag.\nimport {  Vector3, HemisphericLight, Scene, Mesh, TransformNode, Animation, SceneLoader, PointerEventTypes, Node, AssetsManager, ArcRotateCamera, StateCondition, PBRMaterial, Color3 } from \"@babylonjs/core\";\nimport SceneComponent from \"./SceneComponent\"; // uses above component in same directory\nimport { MyRoomState, Tile } from './schema/MyRoomState';\nimport \"./App.css\";\nimport \"@babylonjs/loaders/glTF\";\nimport \"@babylonjs/inspector\";\nimport TilePanel from './TilePanel';\nimport { Nullable } from \"@babylonjs/core/types\";\nimport Chat from \"./Chat\";\nimport { buildingTypes, terrainTypes } from \"./schema/WorldObjects\";\nimport Help from \"./Help\";\nimport BuildPanel from \"./BuildPanel\";\n\nclass GameObject {\n    parentMesh : Mesh;\n    // buildMesh: Mesh;\n\n    constructor(folder: string, glb: string, assetManager: AssetsManager) {\n        const task = assetManager.addMeshTask(\"task\", \"\", `${process.env.PUBLIC_URL}/assets/${folder}/`, `${glb}.glb`);\n        task.onSuccess = (task) => {\n            this.parentMesh = task.loadedMeshes[0] as Mesh;\n            this.parentMesh.position.z = 1000000;\n            // this.buildMesh = this.parentMesh.clone(`build${this.parentMesh.name}`, null);\n            // this.buildMesh.getChildMeshes().forEach(mesh => {\n            //     mesh.material = mesh.material.clone(\"\");\n            //     mesh.material.alpha = 0.5;\n            //     (mesh.material as PBRMaterial).alpha = 0.1;\n            //     (mesh.material as PBRMaterial).alphaMode = 1;\n            // })\n        }\n    }\n}\n\nexport default () => {\n    const [focusedKey, setFocusedKey] = useState(-1);\n    const [roomState, setRoomState] = useState(new MyRoomState());\n    const [state, updateState] = React.useState({});\n    const forceUpdate = React.useCallback(() => updateState({}), []);\n    const [room, setRoom] = useState<Nullable<Colyseus.Room>>(null);\n    let terrains : GameObject[] = [];\n    let buildings : GameObject[] = [];\n    // let buildType = 0;\n    // let buildMesh : Mesh = null;\n\n\n    async function loadGameData(scene: Scene) {\n        const assetManager = new AssetsManager(scene);\n        terrainTypes.forEach(type => {\n            terrains.push(new GameObject(\"tiles\", type.asset, assetManager));\n        })\n        buildingTypes.forEach(type => {\n            buildings.push(new GameObject(\"buildings\", type.asset, assetManager));\n        })\n        await assetManager.loadAsync();\n    };\n\n    // thanks to RedBlobGames\n    function getCoords(key: number, width: number) : [x: number, y: number] {\n        const [col, row] = [key % width, Math.floor(key / width)];\n        return getPixelFromHex(col,row);\n    }\n\n    function getPixelFromHex(col: number, row: number) : [x: number, y: number] {\n        const sz = 1.1;\n        return [sz * (Math.sqrt(3) * col + Math.sqrt(3) /2 * row), sz * 3/2 * row];\n    }\n\n    function connect(scene: Scene) {\n        var client = new Colyseus.Client('wss://mamawn.us-west-1.colyseus.dev'); // replace with ws://localhost:port if running server locally\n        client.joinOrCreate(\"my_room\").then(room => {\n            setRoom(room);\n            console.log(room.sessionId, \"joined\", room.name);\n            room.onStateChange((state : any) => {\n                setRoomState(state);\n                forceUpdate();\n            });\n            const state = (room.state as MyRoomState);\n            const [cx, cy] = getPixelFromHex(25 / 2, 25 / 2);\n            (scene.cameras[0] as ArcRotateCamera).target.set(cx,2,cy);\n            (scene.cameras[0] as ArcRotateCamera).radius = 40;\n            \n            state.tiles.onAdd = (tile: Tile, key: number) => {\n                const [x,y] = getCoords(key, state.width);\n                let transformNode  = new TransformNode(`${key}`, scene);\n                transformNode.position.set(x, tile.height, y);\n                transformNode.metadata = {key};\n                let terrainMesh = terrains[tile.terrainType].parentMesh.clone(`tile`, transformNode);\n                terrainMesh.position.set(0,0,0);\n                terrainMesh.isPickable = true;\n                // terrainMesh.enablePointerMoveEvents = true;\n                // terrainMesh.getChildMeshes().forEach((mesh)=>mesh.enablePointerMoveEvents=true);\n                let buildingNode : TransformNode = null;\n                let buildingMesh : Mesh = null;\n                tile.listen(\"building\", (currentValue, previousValue) => {\n                    if (previousValue) {\n                        const animation = Animation.CreateAndStartAnimation(\"build\",  buildingNode, \"position.y\", 60, 10, 1, 0);\n                        animation.loopAnimation = false;\n                        animation.onAnimationEndObservable.add((eventData) => {eventData.target.dispose();});\n                    }\n                    if (currentValue) {\n                        buildingNode = new TransformNode(\"building\", scene);\n                        buildingNode.parent = transformNode;\n                        buildingMesh = buildings[currentValue.type].parentMesh.clone(`building`, buildingNode);\n                        buildingMesh.position.set(0,0,0);\n                        const animation = Animation.CreateAndStartAnimation(\"build\", buildingNode, \"position.y\", 60, 10, 0, 1);\n                        animation.loopAnimation = false;\n                        tile.building.listen(\"rotation\", (currentValue, previousValue) => {\n                            buildingNode.rotation.y = tile.building.rotation;\n                        })\n                    }\n                })\n                tile.listen(\"terrainType\", (currentValue, previousValue) => {\n                    if (previousValue !== null) {\n                        terrainMesh.dispose();\n                    }\n                    if (currentValue !== null) {\n                        terrainMesh = terrains[tile.terrainType].parentMesh.clone(`tile`, transformNode);\n                        terrainMesh.position.set(0,0,0);\n                        terrainMesh.setEnabled(true);\n                        terrainMesh.isPickable = true;\n                    }\n                })\n                tile.listen(\"height\", (currentValue, previousValue) => {\n                    transformNode.position.y = tile.height;\n                })\n            }\n            scene.onPointerObservable.add((pointerInfo) => {\n                let key = -1;\n                if (pointerInfo.pickInfo && pointerInfo.pickInfo.pickedMesh) {\n                    const mesh = pointerInfo.pickInfo.pickedMesh;\n                    let keyNode : Node = mesh;\n                    while(!keyNode.metadata || !keyNode.metadata.key) {\n                        keyNode = keyNode.parent;\n                        if (!keyNode) return;\n                    }\n                    key = keyNode.metadata.key;\n                }\n                if (pointerInfo.type === PointerEventTypes.POINTERDOWN) {\n                    setFocusedKey(key)\n                } /* else if (buildType != -1) {\n                    if (key == -1) {\n                        if (buildMesh != null) {\n                            buildMesh.dispose();\n                            buildMesh = null;\n                        }\n                    } else {\n                        if (buildMesh == null) {\n                            const nm = buildings[buildType].buildMesh.clone(\"build\", null);\n                            buildMesh = nm;\n                        }\n                        const [x,y] = getCoords(key, state.width);\n                        buildMesh.position.x = x;\n                        buildMesh.position.z = y;\n                        buildMesh.position.y = state.tiles[key].height;\n                        console.log(buildMesh.position.toString())\n                    }\n                } */\n            })\n            \n        }).catch(e => {\n            console.log(\"JOIN ERROR\", e);\n        });\n    }\n    const onSceneReady = (scene : Scene) => {\n        loadGameData(scene)\n            .then(() => connect(scene));\n    \n      // This creates and positions a free camera (non-mesh)\n        const camera = new ArcRotateCamera(\n            \"camera\",\n            0,\n            Math.PI / 3,\n            10,\n            new Vector3(0, 0, 0),\n            scene\n        );\n    \n      // This targets the camera to scene origin\n      camera.setTarget(Vector3.Zero());\n    \n      const canvas = scene.getEngine().getRenderingCanvas();\n    \n      // This attaches the camera to the canvas\n      camera.attachControl(canvas, true);\n    \n      // This creates a light, aiming 0,1,0 - to the sky (non-mesh)\n      var light = new HemisphericLight(\"light\", new Vector3(0, 1, 0), scene);\n    \n      // Default intensity is 1. Let's dim the light a small amount\n      light.intensity = 0.7;\n    \n    };\n\n    /**\n * Will run on every frame render. \n */\nconst onRender = (scene : Scene) => {};\n\n  return <div>\n    <SceneComponent antialias onSceneReady={onSceneReady} onRender={onRender} id=\"my-canvas\" />\n    <TilePanel\n        tile={roomState.tiles[focusedKey]}\n        demolishBuilding={() => room.send(\"demolish\", {key: focusedKey})}\n        buildBuilding={type => room.send(\"build\", {key: focusedKey, type})}\n        setTerrainType={type => room.send(\"changeTerrainType\", {key: focusedKey, type})}\n        setHeight={height => room.send(\"setHeight\", {key: focusedKey, height})}\n        setRotation={rotation => room.send(\"setRotation\", {key: focusedKey, rotation})}\n    />\n    <Chat\n        players={roomState.players}\n        sendMessage={(message) => room.send(\"message\", {message})}\n        messages={roomState.messages}\n    />\n    <h1 id=\"world-name\">{roomState.name}</h1>\n    {/* <BuildPanel setBuildType={type => buildType = type}/> */}\n    <Help/>\n  </div>\n};\n","import logo from './logo.svg';\nimport './App.css';\nimport Game from './Game';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Game/>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}